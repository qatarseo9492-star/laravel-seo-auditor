   INFO Discovering packages.  <?php use Illuminate\Database\Migrations\Migration; use Illuminate\Database\Schema\Blueprint; use Illuminate\Support\Facades\Schema; 
use Illuminate\Support\Facades\DB; return new class extends Migration {
                                                                                                                                                                               public 
                function up(): void { if (!Schema::hasColumn('topic_analyses', 'urls_signature')) { Schema::table('topic_analyses', function (Blueprint $table) { 
                $table->string('urls_signature')->nullable()->after('urls_list');
  laravel/sail ................................................................................................................................ DONE }); 
  laravel/sanctum ............................................................................................................................. DONE // Backfill 
  existing rows with deterministic signatures laravel/tinker 
  .............................................................................................................................. DONE try { $rows = 
  DB::table('topic_analyses')->select('id', 'urls_list')->get(); foreach ($rows as $row) { $arr = json_decode($row->urls_list, true); if nesbot/carbon 
  ............................................................................................................................... DONE (!is_array($arr)) { $arr = 
  []; } nunomaduro/collision ........................................................................................................................ DONE // clean 
  -> trim -> dedupe -> sort nunomaduro/termwind 
  ......................................................................................................................... DONE $arr = 
  array_values(array_unique(array_filter(array_map('trim', $arr)))); sort($arr, SORT_NATURAL | SORT_FLAG_CASE); $sig = spatie/laravel-ignition 
  ..................................................................................................................... DONE sha1(json_encode($arr, 
  JSON_UNESCAPED_SLASHES)); DB::table('topic_analyses')->where('id', $row->id)->update(['urls_signature' => $sig]);
                                                                                                                                                                                           }
            } catch (\Throwable $e) {
Generated optimized autoload files containing 5831 classes // If anything goes wrong, leave the column nullable and continue. [master_fggxdtvjrz]:public_html$ php 
artisan migrate --force }
                                                                                                                                                                                       // Add 
                                                                                                                                                                                       // an 
                                                                                                                                                                                       // index 
                                                                                                                                                                                       // for 
                                                                                                                                                                                       // faster 
                                                                                                                                                                                       // lookups
                                                                                                                                                                                       Schema::table('topic_analyses', 
                                                                                                                                                                                       function 
                                                                                                                                                                                       (Blueprint 
                                                                                                                                                                                       $table) 
                                                                                                                                                                                       { 
                                                                                                                                                                                       $table->index('urls_signature', 
                                                                                                                                                                                       'topic_analyses_urls_signature_index');
   INFO Running migrations.  });
                                                                                                                                                                                   }
    }
    public function down(): void { if (Schema::hasColumn('topic_analyses', 'urls_signature')) { Schema::table('topic_analyses', function (Blueprint $table) { 
                $table->dropIndex('topic_analyses_urls_signature_index'); $table->dropColumn('urls_signature');
  2025_08_27_010000_add_urls_signature_to_topic_analyses_table ............................................................................ 3ms FAIL });
                                                                                                                                                                                   }
    }
};
   Illuminate\Database\QueryException
                                                                                                                                                                           
  SQLSTATE[42S22]: Column not found: 1054 Unknown column 'urls_list' in 'topic_analyses' (Connection: mysql, SQL: alter table `topic_analyses` add `urls_signature` 
  varchar
(255) null after `urls_list`)
                                                                                                                                                                           
  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:793 789▕ // If an exception occurs when attempting to run a query, we'll format the error 790▕ 
    // message to include the bindings with SQL, which will make this exception a
    791▕ // lot more helpful to the developer instead of just the database's errors. 792▕ catch (Exception $e) { ➜ 793▕ throw new QueryException( 794▕ 
    $this->getName(), $query, $this->prepareBindings($bindings), $e 795▕ ); 796▕ } 797▕ }
                                                                                                                                                                           
  i A column was not found: You might have forgotten to run your database migrations.       https://laravel.com/docs/master/migrations#running-migrations
                                                                                                                                                                           
      +9 vendor frames
                                                                                                                                                                           
  10 database/migrations/2025_08_27_010000_add_urls_signature_to_topic_analyses_table.php:3 Illuminate\Support\Facades\Facade::__callStatic() +24 vendor frames
                                                                                                                                                                           
  35 artisan:35 Illuminate\Foundation\Console\Kernel::handle()
                                                                                                                                                                           
[master_fggxdtvjrz]:public_html$PHP
EXIT

